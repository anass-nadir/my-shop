apiVersion: skaffold/v2beta13
kind: Config
metadata:
  name: my-shop
deploy:
  kubectl:
    manifests:
      - infra/k8s/dev/*.yaml
build:
  local:
    push: false
  tagPolicy:
    sha256: {}
  artifacts:
    - image: myshop/auth
      context: app
      docker:
        dockerfile: Dockerfile.dev
        buildArgs:
          Service: auth
      sync:
        infer:
          - '**/*.ts'
          - '**/*.js'
          - '**/*.map'
    - image: myshop/cart
      context: app
      docker:
        dockerfile: Dockerfile.dev
        buildArgs:
          Service: cart
      sync:
        infer:
          - '**/*.ts'
          - '**/*.js'
          - '**/*.map'
    - image: myshop/product
      context: app
      docker:
        dockerfile: Dockerfile.dev
        buildArgs:
          Service: product
      sync:
        infer:
          - '**/*.ts'
          - '**/*.js'
          - '**/*.map'

    - image: myshop/payment
      context: app
      docker:
        dockerfile: Dockerfile.dev
        buildArgs:
          Service: payment
      sync:
        infer:
          - '**/*.ts'
          - '**/*.js'
          - '**/*.map'

    - image: myshop/client
      context: app/client
      docker:
        dockerfile: Dockerfile.dev
      sync:
        manual:
          - src: 'src/**/*.js'
            dest: .
          - src: 'src/**/*.jsx'
            dest: .
          - src: 'src/**/*.scss'
            dest: .
